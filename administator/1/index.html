<!DOCTYPE html>
<html>
 <head> 
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width initial-scale=1" /> 
  <title>python发送邮件</title> 
  <link rel="stylesheet" type="text/css" href="/CSS/hested.css" /> 
 </head> 
 <body class="typora-export os-windows"> 
  <div id="write" class="is-node">
   <h1><a name="活用python" class="md-header-anchor"></a><span>活用python</span></h1>
   <blockquote>
    <p><span>原创</span><span> </span><span>Administator</span></p>
   </blockquote>
   <p><span>不是我说，python这个语言挺strong的，它可以直接帮你做许多事，而且简单上手。</span> <span>我只学了三个星期，就开发出了几样有意思的东西。</span></p>
   <hr />
   <h3><a name="1邮件发送程序" class="md-header-anchor"></a><span>1.邮件发送程序</span></h3>
   <p><span>通过自动登录邮箱，以及smtplib库发送邮件</span></p>
   <pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="python" style="break-inside: unset;">
    <div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python">
     <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;">
      <textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea>
     </div>
     <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
     <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
     <div class="CodeMirror-scroll" tabindex="-1">
      <div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;">
       <div style="position: relative; top: 0px;">
        <div class="CodeMirror-lines" role="presentation">
         <div role="presentation" style="position: relative; outline: none;">
          <div class="CodeMirror-measure"></div>
          <div class="CodeMirror-measure"></div>
          <div style="position: relative; z-index: 1;"></div>
          <div class="CodeMirror-code" role="presentation" style="">
           <div class="CodeMirror-activeline" style="position: relative;">
            <div class="CodeMirror-activeline-background CodeMirror-linebackground"></div>
            <div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div>
            <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">smtplib</span></span></pre>
           </div>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">email</span>.<span class="cm-property">mime</span>.<span class="cm-property">text</span> <span class="cm-keyword">import</span> <span class="cm-variable">MIMEText</span></span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">msg_from</span>=<span class="cm-builtin">input</span>(<span class="cm-string">&quot;请输入您的邮箱 Please enter your email&quot;</span>)</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pwd</span>=<span class="cm-builtin">input</span>(<span class="cm-string">&quot;请输入第三方授权码 Please enter a third-party verification code&quot;</span>)</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">to</span>=<span class="cm-builtin">input</span>(<span class="cm-string">&quot;请输入目标邮箱地址 Please enter the target email address&quot;</span>)</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">subject</span>=<span class="cm-builtin">input</span>(<span class="cm-string">&quot;请输入邮件标题 Please enter a message header&quot;</span>)</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">content</span>=<span class="cm-builtin">input</span>(<span class="cm-string">&quot;请输入邮件正文 Please enter the message body&quot;</span>)</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">msg</span>=<span class="cm-variable">MIMEText</span>(<span class="cm-variable">content</span>)</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">msg</span>[<span class="cm-string">&quot;Subject&quot;</span>]=<span class="cm-variable">subject</span></span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">msg</span>[<span class="cm-string">&quot;From&quot;</span>]=<span class="cm-variable">msg_from</span></span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">msg</span>[<span class="cm-string">&quot;To&quot;</span>]=<span class="cm-variable">to</span></span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ss</span>=<span class="cm-variable">smtplib</span>.<span class="cm-property">SMTP_SSL</span>(<span class="cm-string">&quot;smtp.sina.com&quot;</span>,<span class="cm-number">465</span>)</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ss</span>.<span class="cm-property">login</span>(<span class="cm-variable">msg_from</span>,<span class="cm-variable">pwd</span>)</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ss</span>.<span class="cm-property">sendmail</span>(<span class="cm-variable">msg_from</span>,<span class="cm-variable">to</span>,<span class="cm-variable">msg</span>.<span class="cm-property">as_string</span>())</span></pre>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 358px;"></div>
      <div class="CodeMirror-gutters" style="display: none; height: 358px;"></div>
     </div>
    </div></pre>
   <h3><a name="2爬虫" class="md-header-anchor"></a><span>2.爬虫</span></h3>
   <p><span>爬虫……不用我介绍了，python就是爬虫最6</span> <span>我的爬虫通过不同的user agent伪装成浏览器，再自定义了open，只要是正确的url，并且是http协议，大多数都可以爬取</span> <span>如果不能正常爬取请换一种解码方式</span></p>
   <pre spellcheck="false" class="md-fences md-end-block ty-contain-cm md-focus" lang="python" style="break-inside: unset;">
    <div class="CodeMirror cm-s-inner CodeMirror-wrap CodeMirror-focused" lang="python">
     <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;">
      <textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea>
     </div>
     <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
     <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
     <div class="CodeMirror-scroll" tabindex="-1">
      <div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;">
       <div style="position: relative; top: 0px;">
        <div class="CodeMirror-lines" role="presentation">
         <div role="presentation" style="position: relative; outline: none;">
          <div class="CodeMirror-measure"></div>
          <div class="CodeMirror-measure"></div>
          <div style="position: relative; z-index: 1;"></div>
          <div class="CodeMirror-code" role="presentation" style="">
           <div class="CodeMirror-activeline" style="position: relative;">
            <div class="CodeMirror-activeline-background CodeMirror-linebackground"></div>
            <div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div>
            <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">urllib</span>.<span class="cm-property">request</span></span></pre>
           </div>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">re</span></span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">random</span></span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">agent1</span>=<span class="cm-string">&quot;User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1;360SE)&quot;</span></span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">agent2</span>=<span class="cm-string">&quot;User-Agent:Mozilla/5.0(compatible;MSIE9.0;WindowsNT6.1;Trident/5.0;&quot;</span></span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">agent3</span>=<span class="cm-string">&quot;User-Agent:NOKIA5700/UCWEB7.0.2.37/28/999&quot;</span></span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">agentlist</span>=[<span class="cm-variable">agent1</span>,<span class="cm-variable">agent2</span>,<span class="cm-variable">agent3</span>]</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">http_hander</span>=<span class="cm-variable">urllib</span>.<span class="cm-property">request</span>.<span class="cm-property">HTTPHandler</span>()</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">opener</span>=<span class="cm-variable">urllib</span>.<span class="cm-property">request</span>.<span class="cm-property">build_opener</span>(<span class="cm-variable">http_hander</span>)</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">agent</span>=<span class="cm-variable">random</span>.<span class="cm-property">choice</span>(<span class="cm-variable">agentlist</span>)</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">&quot;目前选择的Agent是&quot;</span>,<span class="cm-variable">agent</span>)</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">header</span>={<span class="cm-string">&quot;User-Agent&quot;</span>:<span class="cm-variable">agent</span>}</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">url</span>=<span class="cm-string">r&quot;网页链接&quot;</span> <span class="cm-comment">#url在这里</span></span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">req</span>=<span class="cm-variable">urllib</span>.<span class="cm-property">request</span>.<span class="cm-property">Request</span>(<span class="cm-variable">url</span>,<span class="cm-variable">headers</span>=<span class="cm-variable">header</span>)</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">reponse</span>=<span class="cm-variable">opener</span>.<span class="cm-property">open</span>(<span class="cm-variable">req</span>).<span class="cm-property">read</span>().<span class="cm-property">decode</span></span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">reponse</span>)</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">f</span>=<span class="cm-builtin">open</span>(<span class="cm-string">r&quot;C:\Users\Administator\Desktop\data.txt&quot;</span>,<span class="cm-string">&quot;w&quot;</span>) <span class="cm-comment">#为了防止显示的东西过多，导致卡死，我特意把文件保存到桌面上</span></span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">f</span>.<span class="cm-property">write</span>(<span class="cm-variable">reponse</span>)</span></pre>
           <pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">f</span>.<span class="cm-property">close</span>()</span></pre>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 512px;"></div>
      <div class="CodeMirror-gutters" style="display: none; height: 512px;"></div>
     </div>
    </div></pre>
  </div>  
 </body>
</html>